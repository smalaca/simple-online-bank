<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Transaction History</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
    </style>
</head>
<body>
    <h1>Transaction History for <span id="display-accountNumber"></span></h1>

    <table id="history-table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Type</th>
                <th>Amount</th>
                <th>From</th>
                <th>To</th>
            </tr>
        </thead>
        <tbody id="history-list">
            <!-- Transactions will be loaded here -->
        </tbody>
    </table>

    <p><a href="#" onclick="history.back()">Back</a></p>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const accountNumber = urlParams.get('accountNumber');

        async function loadHistory() {
            if (!accountNumber) return;
            document.getElementById('display-accountNumber').textContent = accountNumber;

            try {
                const response = await fetch(`/api/accounts/${accountNumber}/history`);
                if (!response.ok) throw new Error('Account not found');
                const history = await response.json();
                const list = document.getElementById('history-list');
                list.innerHTML = '';
                history.forEach(t => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${new Date(t.date).toLocaleString()}</td>
                        <td>${t.type}</td>
                        <td>${t.amount.toFixed(2)}</td>
                        <td>${t.from || '-'}</td>
                        <td>${t.to || '-'}</td>
                    `;
                    list.appendChild(tr);
                });
            } catch (error) {
                console.error('Error:', error);
                alert('Could not load transaction history.');
            }
        }

        loadHistory();
    </script>
</body>
</html>
